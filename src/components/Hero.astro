---
import FloatingBottle from './FloatingBottle.jsx';
import bottleImage from '../assets/images/revive-bottle.png';
---

<section id="hero" class="relative min-h-screen flex items-center justify-center px-6 pt-32 pb-16 overflow-hidden">
  
  <!-- Liquid Background Orbs -->
  <div class="absolute inset-0 overflow-hidden -z-10">
    <div class="liquid-orb liquid-orb-accent w-[800px] h-[800px] -top-60 -left-60 animate-float"></div>
    <div class="liquid-orb liquid-orb-white w-[600px] h-[600px] top-40 -right-40 animate-float animation-delay-2000"></div>
    <div class="liquid-orb liquid-orb-accent w-[500px] h-[500px] -bottom-40 left-1/3 animate-float animation-delay-4000"></div>
  </div>

  <div class="max-w-6xl mx-auto grid grid-cols-1 lg:grid-cols-2 gap-8 lg:gap-12 items-center w-full z-10">
    
    <!-- Left Column: Content -->
    <div class="order-2 lg:order-1 flex flex-col space-y-8">

      <!-- Headline -->
      <h1 class="text-5xl md:text-6xl lg:text-7xl font-bold tracking-tight text-white leading-[1.05]">
        Enjoy the night.<br />
        <span class="text-[#c8e321]">Keep the next day.</span>
      </h1>

      <!-- Subheadline -->
      <p class="text-white/60 text-lg lg:text-xl leading-relaxed max-w-lg">
        Science-backed recovery drink that works while you sleep. Wake up refreshed, not wrecked.
      </p>

      <!-- Waitlist Form -->
      <div id="waitlist" class="space-y-4 max-w-md">
        <form id="waitlist-form" class="flex flex-col sm:flex-row gap-3">
          <input 
            type="email" 
            name="email"
            placeholder="Enter your email" 
            class="flex-1 px-5 py-4 rounded-full bg-white/5 border border-white/10 text-white placeholder-white/40 focus:outline-none focus:border-[#c8e321]/50 focus:bg-white/10 transition-all text-base"
            required
          />
          <button 
            type="submit"
            class="btn-primary py-4 px-8 whitespace-nowrap cursor-pointer disabled:opacity-50"
          >
            <span class="default-text">Join Waitlist</span>
            <span class="loading-text hidden">Joining...</span>
          </button>
        </form>
        
        <!-- Status Messages -->
        <div id="success-message" class="hidden text-[#c8e321] text-sm flex items-center gap-2">
          <svg xmlns="http://www.w3.org/2000/svg" class="w-4 h-4" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
            <path stroke-linecap="round" stroke-linejoin="round" d="M4.5 12.75l6 6 9-13.5" />
          </svg>
          You're on the list! We'll be in touch soon.
        </div>
        <div id="error-message" class="hidden text-red-400 text-sm">
          Something went wrong. Please try again.
        </div>

        <!-- Social Proof -->
        <p class="text-white/40 text-sm">
          Join 500+ people already on the waitlist
        </p>
      </div>

      <!-- Features -->
      <div class="flex flex-wrap gap-6 pt-4 text-white/50 text-sm">
        <span class="flex items-center gap-2">
          <svg xmlns="http://www.w3.org/2000/svg" class="w-4 h-4 text-[#c8e321]" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
            <path stroke-linecap="round" stroke-linejoin="round" d="M4.5 12.75l6 6 9-13.5" />
          </svg>
          100% Natural
        </span>
        <span class="flex items-center gap-2">
          <svg xmlns="http://www.w3.org/2000/svg" class="w-4 h-4 text-[#c8e321]" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
            <path stroke-linecap="round" stroke-linejoin="round" d="M4.5 12.75l6 6 9-13.5" />
          </svg>
          Vegan
        </span>
        <span class="flex items-center gap-2">
          <svg xmlns="http://www.w3.org/2000/svg" class="w-4 h-4 text-[#c8e321]" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
            <path stroke-linecap="round" stroke-linejoin="round" d="M4.5 12.75l6 6 9-13.5" />
          </svg>
          Sugar-Free
        </span>
      </div>
    </div>

    <!-- Right Column: Product Visual -->
    <div class="order-1 lg:order-2 relative flex justify-center items-center py-8 lg:py-0">
      <div class="relative">
        <!-- Glow behind bottle -->
        <div class="absolute inset-0 bg-[#c8e321]/20 blur-[100px] rounded-full scale-75"></div>
        <FloatingBottle client:load imageSrc={bottleImage.src} />
      </div>
    </div>

  </div>

  <!-- Scroll indicator -->
  <div class="absolute bottom-8 left-1/2 -translate-x-1/2 animate-bounce hidden lg:block">
    <svg xmlns="http://www.w3.org/2000/svg" class="w-6 h-6 text-white/20" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.5">
      <path stroke-linecap="round" stroke-linejoin="round" d="M19.5 8.25l-7.5 7.5-7.5-7.5" />
    </svg>
  </div>
</section>

<script>
  const form = document.getElementById('waitlist-form') as HTMLFormElement;
  const successMsg = document.getElementById('success-message');
  const errorMsg = document.getElementById('error-message');
  const submitBtn = form?.querySelector('button');
  const defaultText = submitBtn?.querySelector('.default-text');
  const loadingText = submitBtn?.querySelector('.loading-text');
  const input = form?.querySelector('input');

  const SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbz929rqQrGOAhTefMeNhQT4p7p2BQXy7C_Qt3iZ_G7X1HCUyVnhJZrWeMfntdisctdB/exec'; 

  form?.addEventListener('submit', async (e) => {
    e.preventDefault();
    
    successMsg?.classList.add('hidden');
    errorMsg?.classList.add('hidden');
    if (submitBtn) submitBtn.disabled = true;
    if (input) input.disabled = true;
    defaultText?.classList.add('hidden');
    loadingText?.classList.remove('hidden');

    try {
      await fetch(SCRIPT_URL, {
        method: 'POST',
        body: JSON.stringify({ email: input?.value }),
        mode: 'no-cors',
        headers: { 'Content-Type': 'application/json' }
      });

      successMsg?.classList.remove('hidden');
      form?.reset();
    } catch (err) {
      console.error('Error:', err);
      errorMsg?.classList.remove('hidden');
    } finally {
      if (submitBtn) submitBtn.disabled = false;
      if (input) input.disabled = false;
      defaultText?.classList.remove('hidden');
      loadingText?.classList.add('hidden');
      
      setTimeout(() => {
        successMsg?.classList.add('hidden');
      }, 5000);
    }
  });
</script>
