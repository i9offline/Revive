---
import FloatingBottle from './FloatingBottle.jsx';
---

<section class="relative min-h-screen flex items-center justify-center px-6 py-12 overflow-hidden">
  <!-- Liquid Background -->
  <div class="absolute inset-0 w-full h-full overflow-hidden -z-10">
     <div class="absolute top-0 left-1/4 w-[600px] h-[600px] bg-[#c8e321]/20 rounded-full mix-blend-multiply filter blur-[100px] opacity-60 animate-blob"></div>
     <div class="absolute top-0 right-1/4 w-[500px] h-[500px] bg-[#184441]/10 rounded-full mix-blend-multiply filter blur-[80px] opacity-50 animate-blob animation-delay-2000"></div>
     <div class="absolute -bottom-32 left-1/3 w-[600px] h-[600px] bg-[#c8e321]/10 rounded-full mix-blend-multiply filter blur-[120px] opacity-40 animate-blob animation-delay-4000"></div>
  </div>

  <div class="max-w-7xl mx-auto grid grid-cols-1 lg:grid-cols-2 gap-12 lg:gap-20 items-center w-full z-10">
    <!-- Left Column: Content -->
    <div class="flex flex-col space-y-6 text-left">
      
      <!-- Logo -->
      <!-- Logo -->
      <div class="relative inline-block mb-2 self-start">
         <div class="absolute inset-0 bg-[#184441]/10 blur-xl rounded-full scale-125"></div>
         <img src={import.meta.env.BASE_URL + "/images/revive-logo-v2.png"} alt="Revive" class="relative h-16 w-auto brightness-90" />
      </div>

      <!-- Headline -->
      <h1 class="text-5xl md:text-7xl font-bold tracking-tight text-[#184441] leading-[1.05]">
        Enjoy the night. <br /> Keep the next day.
      </h1>

      <!-- Mobile Visual (Visible only on mobile) -->
      <div class="lg:hidden relative flex justify-center items-center w-full min-h-[300px] bg-[#c8e321]/10 rounded-[2rem] overflow-hidden my-4">
         <div class="absolute w-[140%] h-[140%] bg-gradient-to-b from-[#c8e321]/20 to-transparent rounded-full blur-3xl"></div>
         <div class="z-10 transform scale-90">
           <FloatingBottle client:load />
         </div>
      </div>

      <!-- Benefit Icons Row -->
      <div class="grid grid-cols-3 gap-4 border-y border-[#184441]/10 py-6 my-2">
        <div class="flex flex-col items-center text-center space-y-2">
          <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-7 h-7 text-[#184441]">
            <path stroke-linecap="round" stroke-linejoin="round" d="M3.75 13.5l10.5-11.25L12 10.5h8.25L9.75 21.75 12 13.5H3.75z" />
          </svg>
          <span class="text-[10px] md:text-xs font-bold uppercase tracking-wider text-[#184441] leading-tight">Optimized<br/>Recovery</span>
        </div>
        <div class="flex flex-col items-center text-center space-y-2 border-l border-[#184441]/10">
          <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-7 h-7 text-[#184441]">
            <path stroke-linecap="round" stroke-linejoin="round" d="M21 8.25c0-2.485-2.099-4.5-4.688-4.5-1.935 0-3.597 1.126-4.312 2.733-.715-1.607-2.377-2.733-4.313-2.733C5.1 3.75 3 5.765 3 8.25c0 7.22 9 12 9 12s9-4.78 9-12z" />
          </svg>
          <span class="text-[10px] md:text-xs font-bold uppercase tracking-wider text-[#184441] leading-tight">Liver<br/>Support</span>
        </div>
        <div class="flex flex-col items-center text-center space-y-2 border-l border-[#184441]/10">
          <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-7 h-7 text-[#184441]">
            <path stroke-linecap="round" stroke-linejoin="round" d="M12 6v6h4.5m4.5 0a9 9 0 11-18 0 9 9 0 0118 0z" />
          </svg>
          <span class="text-[10px] md:text-xs font-bold uppercase tracking-wider text-[#184441] leading-tight">Wake Up<br/>Fresh</span>
        </div>
      </div>

      <!-- Benefit List -->
      <ul class="space-y-2">
        {["Unique formula, 100% natural, based on adaptogenic plants.", "Irresistible taste, gluten-free, vegan, sugar-free.", "Promotes liver detoxification and restful sleep."].map((item) => (
          <li class="flex items-start gap-3">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="w-5 h-5 text-[#c8e321] shrink-0 mt-0.5">
              <path fill-rule="evenodd" d="M2.25 12c0-5.385 4.365-9.75 9.75-9.75s9.75 4.365 9.75 9.75-4.365 9.75-9.75 9.75S2.25 17.385 2.25 12zm13.36-1.814a.75.75 0 10-1.22-.872l-3.236 4.53L9.53 12.22a.75.75 0 00-1.06 1.06l2.25 2.25a.75.75 0 001.14-.094l3.75-5.25z" clip-rule="evenodd" />
            </svg>
            <span class="text-[#184441] font-medium text-sm md:text-base leading-snug">{item}</span>
          </li>
        ))}
      </ul>
      
      <!-- CTA Form -->
      <div class="pt-2">
        <form id="waitlist-form" class="flex flex-col sm:flex-row gap-3 w-full relative">
          <input 
            type="email" 
            name="email"
            placeholder="Enter your email" 
            class="flex-1 px-6 py-3.5 rounded-full bg-white/40 border border-[#184441]/10 text-[#184441] placeholder-[#184441]/40 focus:outline-none focus:border-[#c8e321] focus:bg-white/60 transition-all backdrop-blur-md disabled:opacity-50"
            required
          />
          <button 
            type="submit"
            class="btn-primary cursor-pointer whitespace-nowrap py-3.5 disabled:opacity-50 disabled:cursor-not-allowed"
          >
            <span class="default-text">Join Waiting List</span>
            <span class="loading-text hidden">Joining...</span>
          </button>
          
          <!-- Status Messages -->
          <div id="success-message" class="hidden absolute -bottom-12 left-0 w-full text-green-800 bg-green-100/80 backdrop-blur-sm px-4 py-2 rounded-lg text-sm font-medium border border-green-200">
            You're on the list! We'll be in touch soon.
          </div>
          <div id="error-message" class="hidden absolute -bottom-12 left-0 w-full text-red-800 bg-red-100/80 backdrop-blur-sm px-4 py-2 rounded-lg text-sm font-medium border border-red-200">
            Something went wrong. Please try again.
          </div>
        </form>

        <script>
          const form = document.getElementById('waitlist-form');
          const successMsg = document.getElementById('success-message');
          const errorMsg = document.getElementById('error-message');
          const submitBtn = form.querySelector('button');
          const defaultText = submitBtn.querySelector('.default-text');
          const loadingText = submitBtn.querySelector('.loading-text');
          const input = form.querySelector('input');

          // REPLACE THIS URL WITH YOUR GOOGLE APPS SCRIPT WEB APP URL
          const SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbz929rqQrGOAhTefMeNhQT4p7p2BQXy7C_Qt3iZ_G7X1HCUyVnhJZrWeMfntdisctdB/exec'; 

          form.addEventListener('submit', async (e) => {
            e.preventDefault();
            
            if (SCRIPT_URL === 'YOUR_GOOGLE_APPS_SCRIPT_URL_HERE') {
              alert('Please configure the Google Apps Script URL in Hero.astro first!');
              return;
            }

            // Reset states
            successMsg.classList.add('hidden');
            errorMsg.classList.add('hidden');
            submitBtn.disabled = true;
            input.disabled = true;
            defaultText.classList.add('hidden');
            loadingText.classList.remove('hidden');

            try {
              const response = await fetch(SCRIPT_URL, {
                method: 'POST',
                body: JSON.stringify({ email: input.value }),
                mode: 'no-cors', // Important for Google Apps Script
                headers: {
                  'Content-Type': 'application/json'
                }
              });

              // Since mode is no-cors, we can't check response.ok
              // We assume success if no error was thrown
              successMsg.classList.remove('hidden');
              form.reset();
            } catch (err) {
              console.error('Error:', err);
              errorMsg.classList.remove('hidden');
            } finally {
              submitBtn.disabled = false;
              input.disabled = false;
              defaultText.classList.remove('hidden');
              loadingText.classList.add('hidden');
              
              // Hide success message after 5 seconds
              setTimeout(() => {
                successMsg.classList.add('hidden');
              }, 5000);
            }
          });
        </script>
      </div>

    </div>

    <!-- Right Column: Visual (Hidden on mobile) -->
    <div class="hidden lg:flex relative justify-center items-center h-full min-h-[400px] lg:min-h-[600px] bg-[#c8e321]/10 rounded-[2.5rem] overflow-hidden">
       <!-- Inner Background Circle -->
       <div class="absolute w-[140%] h-[140%] bg-gradient-to-b from-[#c8e321]/20 to-transparent rounded-full blur-3xl"></div>
       
       <!-- Bottle Component -->
       <div class="z-10 transform scale-100 lg:scale-110">
         <FloatingBottle client:load />
       </div>
    </div>
  </div>
</section>
